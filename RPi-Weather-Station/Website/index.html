<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Microgrid Dashboard</title>
  <style>
    html, body { height: 100%; margin: 0; }
    .app { height: 100%; display: flex; }
    .nav {
      width: 260px;
      background: #0e1a3a;
      color: #fff;
      padding: 18px;
      box-sizing: border-box;
      display: flex;
      flex-direction: column;
    }
    .nav h2 { margin: 0 0 18px; font-family: system-ui, Arial; font-weight: 700; }
    .nav button {
      width: 100%;
      margin: 8px 0;
      padding: 12px;
      border: 0;
      border-radius: 10px;
      cursor: pointer;
      background: #1a2b5a;
      color: #fff;
      font-size: 18px;
      text-align: left;
    }
    .nav button.active { background: #3b66ff; }
    .sidebar-footer {
      margin-top: auto;
      padding-top: 14px;
      font-family: system-ui, Arial;
      font-size: 14px;
      opacity: 0.95;
    }
    .sidebar-footer .label { opacity: 0.9; }
    .sidebar-footer .value { font-size: 16px; margin: 6px 0 12px; }
    .content { flex: 1; background: #08112a; }
    iframe { width: 100%; height: 100%; border: 0; }
  </style>
</head>
<body>
  <div class="app">
    <div class="nav">
      <h2>Grid + logo</h2>

      <button class="navbtn active" data-path="/public-dashboards/e03c190f60b845e7a9bc79071ec055ca">Main</button>
      <button class="navbtn" data-path="/public-dashboards/e03c190f60b845e7a9bc79071ec055ca">Loads</button>
      <button class="navbtn" data-path="/public-dashboards/e03c190f60b845e7a9bc79071ec055ca">Generators</button>
      <button class="navbtn" data-path="/public-dashboards/e03c190f60b845e7a9bc79071ec055ca">Storage</button>

      <div class="sidebar-footer">
        <div class="label">Current Date:</div>
        <div class="value" id="currentDate">Loading...</div>
        <div class="label">Current Time:</div>
        <div class="value" id="currentTime">Loading...</div>
      </div>
    </div>

    <div class="content">
      <iframe id="dashFrame" src=""></iframe>
    </div>
  </div>

  <script>
    const frame = document.getElementById("dashFrame");
    const buttons = Array.from(document.querySelectorAll(".navbtn"));
    const dateEl = document.getElementById("currentDate");
    const timeEl = document.getElementById("currentTime");

    const grafanaPort = 3000;
    const grafanaPathDefault = "/public-dashboards/43d6216ca7c64fa8a7b5259e48e3551e";

    function getGrafanaHost() {
      const h = window.location.hostname;
      const localHosts = ["localhost", "127.0.0.1"];
      if (localHosts.includes(h)) {
        return "localhost";
      }
      return h;
    }

    function buildGrafanaUrl(path) {
      const host = getGrafanaHost();
      return "http://" + host + ":" + grafanaPort + path;
    }

    function setActive(btn) {
      buttons.forEach(b => b.classList.remove("active"));
      btn.classList.add("active");
    }

    function updateClock() {
      const now = new Date();
      dateEl.textContent = now.toLocaleDateString(undefined, { year: "numeric", month: "long", day: "numeric" });
      timeEl.textContent = now.toLocaleTimeString(undefined, { hour12: false });
    }

    buttons.forEach(btn => {
      btn.addEventListener("click", () => {
        setActive(btn);
        frame.src = buildGrafanaUrl(btn.dataset.path);
      });
    });

    frame.src = buildGrafanaUrl(grafanaPathDefault);
    updateClock();
    setInterval(updateClock, 1000);
  </script>
</body>
</html>
